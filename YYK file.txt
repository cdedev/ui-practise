This is modified in yyk branch.next modified by hnk